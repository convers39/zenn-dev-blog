---
title: "Highcharts å•é¡Œé›†"
emoji: "ğŸ”–"
type: "tech"
topics:
  - "javascript"
  - "highcharts"
published: true
published_at: "2021-12-04 10:59"
---

ã¡ã‚‡ã£ã¨å¤§ã’ã•ãªã‚¿ã‚¤ãƒˆãƒ«ã§ã™ãŒã€æœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§[highcharts](https://www.highcharts.com/)ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€ã„ã‚ã‚“ãªå•é¡Œã¨è§£æ±ºæ³•ã®ã¾ã¨ã‚ã§ã™ã€‚

ã»ã‚“ã®ä¸€éƒ¨ã®æ©Ÿèƒ½ã—ã‹ä½¿ã£ã¦ã„ãªã„ã¨æ€ã„ã¾ã™ãŒã€ãã‚Œã§ã‚‚çµæ§‹å¥¥æ·±ã„ã‚‚ã®ã§ã—ãŸã€‚ã€‚

### ã‚³ãƒ©ãƒ ã‚°ãƒ©ãƒ•ã®ãƒãƒ¼ã‚’å¯¾ã«è¡¨ç¤ºã™ã‚‹

ã‚³ãƒ©ãƒ ã‚°ãƒ©ãƒ•ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¡Œç‚ºã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒªã‚ºã”ã¨ã«ãƒãƒ¼ã‚¬ä½œã‚‰ã‚Œã¾ã™ã€‚å…¬å¼ã®ä¾‹ã§è¨€ãˆã°ã€[ã“ã¡ã‚‰ã®é™æ°´ã‚°ãƒ©ãƒ•](https://jsfiddle.net/2megyswL/)ã¨ãªã‚Šã¾ã™ã€‚

@[jsfiddle](https://jsfiddle.net/2megyswL/)


ä¾‹ãˆã°ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’å¯¾ã§ä¸Šä¸‹ã«è¡¨ç¤ºã—ãŸã„ã€ã¨ã„ã†æ™‚ã«ã€ã¾ãšã¯ã‚¹ã‚¿ãƒƒã‚¯ã®è¨­å®šã‚’ãƒãƒ¼ãƒãƒ«ã¨ã—ã¦ã€ãã‚Œã§ãƒã‚¤ãƒŠã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°ã€å¯¾ã«è¡¨ç¤ºã§ãã¾ã™ã€‚ã“ã¡ã‚‰ãŒä¾‹ã§ã™ã€‚

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/)

### ãƒã‚¤ãƒŠã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ—ãƒ©ã‚¹ã«è¡¨ç¤º

ä¸Šè¨˜ã®å¤‰æ›´ã«ä¸€ã¤å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚é™æ°´é‡ãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‹ã‚ã‘ãŒãªã„ã§ã™ã‹ã‚‰ã€å¯¾ã«è¡¨ç¤ºã™ã‚‹ã¨ã¯è¨€ãˆã€ãƒ‡ãƒ¼ã‚¿ãã®ã‚‚ã®ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚ã“ã“ã§è§£æ±ºã—ãŸã„ã®ã¯ï¼š

- ãƒ‡ãƒ¼ã‚¿ã‚’å¯¾ã«è¡¨ç¤º
- ãƒ‡ãƒ¼ã‚¿ã¯å…¨éƒ¨ãƒ—ãƒ©ã‚¹ã«è¡¨ç¤º

ã“ã“ã§ä½¿ã†ã®ãŒãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã§ã™ã€‚yè»¸ã®å†…å®¹ã ã‘ã§ã¯ã‚“ãã€tooltipã®ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã‚‚ãƒã‚¤ãƒŠã‚¹ã‹ã‚‰ãƒ—ãƒ©ã‚¹ã«ä¿®æ­£ã—ã¾ã™ã€‚

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/9/)

### yè»¸ã«åˆ¥ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ãŸã„

ä¾‹ãˆã°æ°—æ¸©ã®ãƒ‡ãƒ¼ã‚¿ã‚‚è¿½åŠ ã—ãŸã„ã€ã¨ã„ã†å ´åˆã¯ã€yè»¸ã‚’è¿½åŠ ã—ã¾ã™ã€‚

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/15/)

ã“ã“ã§yAxisã®oppositeå±æ€§ã‚’trueã«ã™ã‚‹ã“ã¨ã§å·¦å´ã«ç½®ãã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒªã‚ºã§ã¯ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¾ã‚¿ã‚¤ãƒ—ï¼ˆã‚³ãƒ©ãƒ ã‹ãƒ©ã‚¤ãƒ³ã‹ã¨ã‹ï¼‰ã€å¯¾å¿œã™ã‚‹yè»¸ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§èª¿æ•´å¯èƒ½ã€‚

### é›£å•ï¼šyè»¸ã®0ã‚’çœŸã‚“ä¸­ã«ã—ãŸã„

ã“ã‚Œã¯å¤§å¤‰å›°ã‚Šã¾ã—ãŸã€‚ä»Šã®ã‚µãƒ³ãƒ—ãƒ«ã§è¦‹ãŸã‚‰ã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã®å¹…ãŒé•ã†ã®ã§ã€0ãŒçœŸã‚“ä¸­ã«ãã¾ã›ã‚“ã€‚

![](https://storage.googleapis.com/zenn-user-upload/a24e882ba005-20211204.png)

ã“ã‚Œã«ã¤ã„ã¦ã„ã‚ã‚“ãªè§£æ±ºæ–¹æ³•ãŒã‚ã‚Šã¾ã™ãŒã€ä¸€ç•ªç°¡å˜ãªã®ã¯ã€yè»¸ã®æœ€å¤§å€¤ã¨æœ€å°å€¤ã‚’å†è¨­å®šã™ã‚‹ã“ã¨ã§ã™ã€‚

```js
function alignAxisCenter(chart, name) {
    let axis = chart.yAxis.find(axis => axis.axisTitle.textStr == name);
    if (!axis) {
        return;
    }
    // let { dataMax, dataMin } = axis.getExtremes();
    // let maxVal = Math.max(Math.abs(dataMin), Math.abs(dataMax));
    let maxVal = Math.max(...axis.tickPositions);
    console.log('y axis max value', maxVal)
    // yè»¸ã®æœ€å¤§å€¤ã¨æœ€å°å€¤ã‚’ä¸€ç·’ï¼ˆçµ¶å¯¾å€¤ï¼‰ã«ã™ã‚‹
    axis.setExtremes(maxVal * -1, maxVal);
}
```

ä¸‹è¨˜ã®é€šã‚Šã€å¤§ä½“ã®ã‚±ãƒ¼ã‚¹ã¯ã“ã‚Œã§å¯¾å¿œã§ãã¾ã™ãŒã€ä¸€éƒ¨æ¥µç«¯ãªå ´åˆã¯å¯¾å¿œã§ãã¾ã›ã‚“ã€‚

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/18/)

ä¾‹ãˆã°ã€ã‚°ãƒ©ãƒ•ã®ä¸Šéƒ¨ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä¸€å®šé‡ã§å¢—åŠ ã™ã‚‹ã¨ã€highchartsãŒä¸Šä¸‹ã®ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ã—ã€0ãŒçœŸã‚“ä¸­ã§ãªããªã‚Šã¾ã™ã€‚

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/21/)

### é›£å•ç¶šï¼šyè»¸ã®0ã‚’çœŸã‚“ä¸­ã«ã—ãŸã„

å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€ä¸Šè¨˜ã®ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã—ãŸã€‚ã‚°ãƒ©ãƒ•ä¸Šéƒ¨ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®ã‚¢ã‚¤ã‚³ãƒ³ã¨ã‹ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ ã—ã¦ã„ã‚‹ã®ã§ã€çµå±€ãã®é–¢ä¿‚ã§å‰ç¯€ã®æ–¹æ³•ãŒç„¡åŠ¹ã¨ãªã‚Šã¾ã™ã€‚

ãã®æ™‚ã«æœ€çµ‚æ­¦å™¨ã‚’ä½¿ã„ã¾ã™ã€‚tickPositionerã§ã™ã€‚[å…¬å¼ã®ä¾‹](https://jsfiddle.net/gh/get/library/pure/highcharts/highcharts/tree/master/samples/highcharts/xaxis/tickpositions-tickpositioner/)ï¼š

@[jsfiddle](https://jsfiddle.net/gh/get/library/pure/highcharts/highcharts/tree/master/samples/highcharts/xaxis/tickpositions-tickpositioner/)
ï¼ˆã‚ˆãåˆ†ã‹ã‚‰ã‚“ãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼‰

å…¬å¼ã®ä¾‹ã ã‘ã§ã¯æˆ‘ã€…ã®ç›®çš„ã«é”æˆã§ãã¾ã›ã‚“ã€‚0ã‚’çœŸã‚“ä¸­ã«ãŠããŸã„ã¨ã„ã†ã“ã¨ã¯ã€ç›®ç››ï¼ˆtickï¼‰ã®æ•°ãŒï¼“ä»¥ä¸Šã®å¥‡æ•°ã¨ã®ã“ã¨ã€‚tickPositionerã¯ç›®ç››ã®é…åˆ—ã‚’ãƒªã‚¿ãƒ¼ãƒ³ã™ã‚‹ã®ã§ã€ç›®ç››ã®æ•°ã‚’æ±ºã‚ã¦ãŠãã¨ã€çµ¶å¯¾ãã†ãªã‚‰ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

ä¸€èˆ¬åŒ–å¯èƒ½ãªè§£æ±ºç­–ã¯ã“ã‚Œï¼š

```js
const TICK_PRECISION = 2;
// yè»¸ã®ãƒ‡ãƒ¼ã‚¿æœ€å¤§å€¤ã‚’ã‹ã‘ã‚‹å€ç‡ã€ç›®ç››ã®ä¸Šé™ã‚’è¨­å®š
const AXIS_MAX_EXPAND_RATE = 1.2;
// yè»¸ã®åˆ†å‰²ã‚’å¥‡æ•°ã§æ±ºã‚ã‚‹
function setAxisTicks(axis, tickCount) {
    // ãƒ‡ãƒ¼ã‚¿ã®æœ€å¤§å€¤ã‚’å–å¾—ã—ã€ä¸Šä¸‹ã«ä½™è£•ã‚’å–ã‚‹ãŸã‚ã«ä¸€å®šã®ä¹—ç‡ã§æœ€å¤§å€¤ã‚’å¢—åŠ 
    let maxDeviation = (Math.max(Math.abs(axis.dataMax), Math.abs(axis.dataMin)) * AXIS_MAX_EXPAND_RATE).toPrecision(TICK_PRECISION);
    // å°æ•°å¯¾å¿œã®ãŸã‚ä¸€å›æ•´æ•°ã«
    let wholeMaxDeviation = maxDeviation * 10 ** TICK_PRECISION;
    // halfCountã¯0ä¸Šä¸‹ã®tickã®æ•°
    let halfCount = Math.floor(tickCount / 2);
    // æœ€å¤§å€¤ã¨ä¸€ç•ªè¿‘ã„halfCountã§å‰²ã‚Œã‚‹å€¤ã‚’æ¢ã—ã€ãã‚Œã‚’yè»¸ã®æœ€å¤§å€¤ã«ã™ã‚‹
    while (wholeMaxDeviation % halfCount != 0) {
        wholeMaxDeviation++;
    }
    // halfCountåˆ†ã®ä¸€ã®å€¤ã‚’è¨ˆç®—
    let baseTick = (wholeMaxDeviation / halfCount) / 10 ** TICK_PRECISION;
    let tickPositions = [];
    for (let i = -halfCount; i <= halfCount; i++) {
        // å°æ•°è¨ˆç®—ã«ç²¾åº¦ã®å•é¡ŒãŒã‚ã‚‹ã®ã§ã€toFixedã§ä¸è¦ãªéƒ¨åˆ†ã‚’åˆ‡ã‚Šæ¨ã¦
        let tick = parseFloat((baseTick * i).toFixed(TICK_PRECISION));
        tickPositions.push(tick);
    }
    // console.log('tick positions', tickPositions);
    return tickPositions;
}
```

å®Ÿéš›ã®åŠ¹æœã‚’è¦‹ã‚‹ã¨æ—©ã„ã‹ã‚‚ï¼š

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/24/)

ã¡ãªã¿ã«ã€tickAmountã¨ã„ã†å±æ€§ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã‚ã‚Œã¯æ•°ã ã‘ã‚’æ±ºã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€0ãŒã©ã“ã«æ¥ã‚‹ã‹ã¯ãƒ‡ãƒ¼ã‚¿æ¬¡ç¬¬ã§ã™ã€‚ã¾ãŸã€tickPositionerã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯å„ªå…ˆã•ã‚Œã¾ã™ã€‚

ãŸã ã€tickAmountã‚’ä¸Šè¨˜ã®ä¾‹ã«åˆã‚ã›ã‚‹ã¨ã€ç´°ã‹ã„ä¿®æ­£ãŒã§ãã¾ã™ã€‚ä¸Šè¨˜ã®ä¾‹ã«ã¯ã€å·¦å³ã®yè»¸ã®ç›®ç››ã®æ•°ãŒåˆã„ã¾ã›ã‚“ã€‚ãã‚Œã§ã€å³ã®æ°—æ¸©ã®ç›®ç››ã®ç·šã‚‚å·¦ã¨ãšã‚Œã¦ã„ã¾ã™ã€‚ã“ã“ã§å³ã®è»¸ã«tickAmountã‚’æŒ‡å®šã™ã‚‹ã¨è§£æ±ºã§ãã¾ã™ã€‚

@[jsfiddle](https://jsfiddle.net/convers39/y9jwxzvd/25/)

å˜ç´”ã«ä¸€æ–¹ã®è»¸ã®ç›®ç››ç·šã‚’éš ã—ãŸã„ãªã‚‰ã€gridLineWidthã‚’0ã«å¤‰ãˆã‚Œã°ã„ã‘ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1ã§ã™ã€‚ç›®ç››æ•°ãŒåŒã˜ã®ã¨ãã¯é‡ãªã‚‹ã®ã§0ã«å¤‰ãˆãªãã¦ã‚‚åŠ¹æœã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚

### ã¾ã¨ã‚

ã‚°ãƒ©ãƒ•ã‚’å‡ºã™ã«ã¯highchartsã‚’ä½¿ã†ã®ãŒçµæ§‹ãŠã™ã™ã‚ã§ã™ã€‚åŸºæœ¬çš„ãªè¨­å®šã¨ã‹ã¯å…¬å¼ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚€ã¨å¤§ä½“åˆ†ã‹ã‚‹ãŒã€å°‘ã—ç‰¹åˆ¥ãªã‚±ãƒ¼ã‚¹ã«ãªã‚‹ã¨stack overflowã¨ã‹ã€å…¬å¼ã®ãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã¨ã‹ã§æ¢ã•ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã€‚ãã‚Œã§ã‚‚è§£æ±ºã§ããªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ã¨ã„ã†æ™‚ã¯è‡ªåˆ†ã§ä½œã‚Šè¾¼ã¿ã™ã‚‹ã—ã‹ãªã„ã¨ã€‚ä»Šå›ã¯ã„ãã¤ã‹ç‰¹åˆ¥ãªã‚±ãƒ¼ã‚¹ã‚’ã‚ã’ã¦ã€è§£æ±ºç­–ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

ä»–ã«ã‚‚è‰²ã€…ã¨å•é¡Œã¨è§£æ±ºç­–ãŒã‚ã‚Šã¾ã™ãŒã€ä»Šæ—¥ã¯ä¸€æ—¦ã“ã‚Œã§åˆ‡ã‚Šä¸Šã’ã¾ã™ã€‚
