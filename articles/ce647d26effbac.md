---
title: "ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åŸºç¤ã‚’å­¦ã¶ãƒ¼å˜ä¸€å§‹ç‚¹æœ€çŸ­çµŒè·¯å•é¡Œ"
emoji: "ğŸ—ºï¸"
type: "tech"
topics:
  - "algorithm"
  - "graph"
published: true
published_at: "2023-05-06 22:55"
---

ã“ã®è¨˜äº‹ã¯ã€ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚·ãƒªãƒ¼ã‚ºã®5ç•ªç›®ã®è¨˜äº‹ã§ã™ã€‚

1. [æ¦‚å¿µã¨è¡¨ç¾æ–¹æ³•](https://zenn.dev/convers39/articles/9b66f263e335d8)
2. [BFSã¨DFS](https://zenn.dev/convers39/articles/1c315cd96a991f)
3. [UnionFind](https://zenn.dev/convers39/articles/ffd666639e7782)
4. [æœ€å°å…¨åŸŸæœ¨](https://zenn.dev/convers39/articles/6126e22dd116fb)
5. å˜ä¸€å§‹ç‚¹æœ€çŸ­çµŒè·¯å•é¡Œâ†’ç¾åœ¨åœ°
6. å…¨ç‚¹å¯¾æœ€çŸ­çµŒè·¯å•é¡Œï¼ˆWIPï¼‰

![](https://storage.googleapis.com/zenn-user-upload/5e7f33f33fe4-20230506.png)

---

å˜ä¸€å§‹ç‚¹æœ€çŸ­çµŒè·¯å•é¡Œ(Single Source Shortest Path Problem)ã¨ã„ã†ã®ã¯ã€**ã‚¦ã‚§ã‚¤ãƒˆã‚ã‚Šã‚°ãƒ©ãƒ•ã«ãŠã„ã¦ã€å§‹ç‚¹ã‹ã‚‰çµ‚ç‚¹ã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã®çµŒè·¯ã‚’æ¢ç´¢ã™ã‚‹**å•é¡Œã‚’æŒ‡ã—ã¦ã„ã¾ã™ã€‚åŸºç¤ç·¨ã§è§¦ã‚ŒãŸBFSã‚‚æœ€çŸ­çµŒè·¯ã«é©ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã‚¦ã‚§ã‚¤ãƒˆãªã—ã®ã‚°ãƒ©ãƒ•ã—ã‹é©å¿œã§ãã¾ã›ã‚“ã€‚ã“ã®å•é¡Œã¯åŸºæœ¬çš„ã«ã€å§‹ç‚¹ã‹ã‚‰å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã¾ã§ã®æœ€çŸ­çµŒè·¯ã‚’è¦‹ã¤ã‘å‡ºã™ã“ã¨ãŒç›®çš„ã«ãªã£ã¦ã„ã¾ã™ã€‚ç¾å®Ÿç”Ÿæ´»ã§ã¯ã€ã‚¦ã‚§ã‚¤ãƒˆä»˜ãã®å ´é¢ãŒå¤šãã‚ã‚‹ã®ã§ã€ãã‚Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®2ã¤ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ã“ã“ã§è¦‹ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## Dijkstra's Algorithm

ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä¸€è¨€ã§è¨€ãˆã°ã€ä»»æ„ã®ãƒãƒ¼ãƒ‰ã‚’å§‹ç‚¹ã¨ã—ã¦ã€ç›®æ¨™ã¨ãªã‚‹ãƒãƒ¼ãƒ‰ã«åˆ°é”ã™ã‚‹ã¾ã§ã€**å§‹ç‚¹ã‹ã‚‰å„ãƒãƒ¼ãƒ‰ã¾ã§ã®åˆè¨ˆæœ€å°ã‚³ã‚¹ãƒˆã‚’æ›´æ–°ã—ãªãŒã‚‰çµŒè·¯ã‚’æ‹¡å¼µã—ã¦ã„ã**ã“ã¨ã§ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/f93180111647-20230506.gif)
å‡ºå…¸ï¼šhttps://commons.wikimedia.org/wiki/File:Dijkstra_Animation.gif

ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ä»¥ä¸‹ã¨ãªã‚Šã¾ã™ã€‚
- å§‹ç‚¹ãƒãƒ¼ãƒ‰ã‚’é¸æŠã—ã€ãã®ãƒãƒ¼ãƒ‰ã¸ã®æœ€çŸ­è·é›¢ã‚’0ã«è¨­å®šã—ã€ä»–ã®ã™ã¹ã¦ã®ãƒãƒ¼ãƒ‰ã¸ã®æœ€çŸ­è·é›¢ã‚’ç„¡é™å¤§ï¼ˆinfï¼‰ã«åˆæœŸåŒ–ã—ã¾ã™ã€‚
- ãƒ’ãƒ¼ãƒ—ã‚’ä½œæˆã—ã€å§‹ç‚¹ãƒãƒ¼ãƒ‰ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã—ã¾ã™ã€‚ã‚­ãƒ¥ãƒ¼ã®å„ã‚¢ã‚¤ãƒ†ãƒ ã¯ã€**å§‹ç‚¹ã‹ã‚‰ã®æœ€çŸ­è·é›¢**ã¨ãƒãƒ¼ãƒ‰ã®ãƒšã‚¢ã¨ãªã‚Šã¾ã™ã€‚
- ã‚­ãƒ¥ãƒ¼ãŒç©ºã«ãªã‚‹ã¾ã§ä»¥ä¸‹ã®æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚
  - ã‚­ãƒ¥ãƒ¼ã‹ã‚‰æœ€å°è·é›¢ã®ãƒãƒ¼ãƒ‰ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚
  - ã™ã§ã«è¦‹ã¤ã‹ã£ã¦ã„ã‚‹ã‚ˆã‚ŠçŸ­ã„çµŒè·¯ãŒã‚ã‚‹å ´åˆã¯ã€ç¾åœ¨ã®ãƒãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚
  - ç¾åœ¨ã®ãƒãƒ¼ãƒ‰ã‹ã‚‰éš£æ¥ã™ã‚‹ã™ã¹ã¦ã®ãƒãƒ¼ãƒ‰ã«å¯¾ã—ã¦ã€æ–°ã—ã„çµŒè·¯ãŒç¾åœ¨ã®æœ€çŸ­è·é›¢ã‚ˆã‚Šã‚‚çŸ­ã„ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
  - çŸ­ã‘ã‚Œã°ã€æœ€çŸ­è·é›¢ã‚’æ›´æ–°ã—ã€ãã®ãƒãƒ¼ãƒ‰ã¨æ–°ã—ã„è·é›¢ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã—ã¾ã™ã€‚

```python
import heapq

def dijkstra(start, graph):
    V = len(graph)
    dist = [float('inf')] * V
    dist[start] = 0

    pq = []
    heapq.heappush(pq, (0, start))

    while pq:
        cur_dist_from_start, cur_node = heapq.heappop(pq)

        if cur_dist_from_start > dist[cur_node]:
            continue

        for next_node, edge_weight in graph[cur_node]:
            # ç¾åœ¨ã®ãƒãƒ¼ãƒ‰ã¾ã§ã®ã‚³ã‚¹ãƒˆã«æ¬¡ã®ãƒãƒ¼ãƒ‰ã¾ã§ã®ã‚¦ã‚§ã‚¤ãƒˆã‚’ä¹—ã›ã¦ã€æœ€å°å€¤ã‚’æ›´æ–°ã™ã‚‹
            dist_to_next_node = dist[cur_node] + edge_weight
            if dist[next_node] > dist_to_next_node:
                dist[next_node] = dist_to_next_node
                heapq.heappush(pq, (dist_to_next_node, next_node))

    return dist_to
```

ä¸Šè¨˜ã®å®Ÿè£…ã‚’è¦‹ã¦æ°—ã¥ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯å°‘ã—ãƒ—ãƒªãƒ æ³•ã¨ä¼¼ã¦ã„ã‚‹ã¨ã“ã‚ãŒã‚ã‚Šã¾ã™ã€‚ã„ãšã‚Œã‚‚è²ªæ¬²æ³•ã§ã€ãƒ’ãƒ¼ãƒ—ã§ã‚³ã‚¹ãƒˆã¨ãƒãƒ¼ãƒ‰ã‚’ä¿å­˜ã—ã€BFSã§æ¢ç´¢ã—ã¦ã„ã¾ã™ã€‚é•ã„ã¨ã„ãˆã°ã€ãƒ—ãƒªãƒ æ³•ã®ãƒ’ãƒ¼ãƒ—ã§ã¯ã€ãƒãƒ¼ãƒ‰é–“ã®ã‚³ã‚¹ãƒˆã‚’ä¿å­˜ã—ã¦ã„ã‚‹ã®ã«å¯¾ã—ã¦ã€ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã§ã¯å§‹ç‚¹ã‹ã‚‰ãƒãƒ¼ãƒ‰ã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆåˆè¨ˆã‚’ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€MSTã‚’æ¢ã—å‡ºã™ã“ã¨ã¨ã€å§‹ç‚¹ã‹ã‚‰å„ãƒãƒ¼ãƒ‰ã¾ã§ã®åˆè¨ˆæœ€å°ã‚³ã‚¹ãƒˆã‚’æ¢ã—å‡ºã™ã“ã¨ã¨ã„ã£ãŸç›®çš„ã®é•ã„ã«ç”±æ¥ã—ã¾ã™ã€‚

ã¾ãŸã€`dist_to`é…åˆ—ã‚„ã€`for`ãƒ«ãƒ¼ãƒ—ã®éƒ¨åˆ†ã®å€¤æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¦‹ã‚‹ã¨ã€å‹•çš„è¨ˆç”»æ³•ãƒ»DP(Dynamic Programming)ã®æ—¢è¦–æ„Ÿã¯ã‚ã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã€‚å®Ÿè³ªãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã¨æ¬¡ã«ç´¹ä»‹ã™ã‚‹ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã‚‚ã€DPã®è€ƒãˆæ–¹ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

[ã“ã¡ã‚‰ã®å‹•ç”»](https://youtu.be/EFg3u_E6eHU)ã¯ã‹ãªã‚Šã‚ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ãã‚Œã¦ã„ã¾ã™ã®ã§ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ´ã‚ãªã„å ´åˆã¯ä¸€è¦‹ã™ã‚‹ä¾¡å€¤ã¯ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚

æ™‚é–“è¤‡é›‘åº¦ã«ã¤ã„ã¦ã€ãƒã‚¤ãƒŠãƒªãƒ¼ãƒ’ãƒ¼ãƒ—ã§æƒ³å®šã™ã‚‹å ´åˆã€ã‚¨ãƒƒã‚¸æ•°ã®å›æ•°åˆ†ãƒ’ãƒ¼ãƒ—ãƒãƒƒãƒ—æ“ä½œã™ã‚‹ã®ã§ã€`O(E*logV)`ã¨ãªã‚Šã¾ã™ã€‚å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã‚’æ¢ç´¢ã™ã‚‹ãŸã‚ã€ã•ã‚‰ã«`O(V)`ãŒã‹ã‹ã‚Šã¾ã™ã®ã§ã€åˆè¨ˆã§`O(V+ElogV)`ã¨ãªã‚Šã¾ã™ã€‚ç©ºé–“è¤‡é›‘åº¦ã«ã¤ã„ã¦ã€ãƒãƒ¼ãƒ‰æ•°ã«å¯¾å¿œã™ã‚‹é…åˆ—ã‚„ãƒ’ãƒ¼ãƒ—ãŒå¿…è¦ãªã®ã§ã€`O(V)`ã¨ãªã‚Šã¾ã™ã€‚

ä¸€ã¤æ³¨æ„ã—ãªã„ã¨ã„ã‘ãªã„ã®ãŒã€ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã€ã‚¦ã‚§ã‚¤ãƒˆãŒæ­£æ•°ã®å ´åˆã®ã¿åŠ¹æœãŒã‚ã‚Šã¾ã™ã€‚ä»®ã«ã‚¦ã‚§ã‚¤ãƒˆãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‹ã¨ã€è²ªæ¬²æ³•ã¯å¤±æ•—ã—ã¾ã™ã€‚ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€ä¸‹è¨˜ã®Bellman-Fordæ³•ãŒåŠ©ã‘ã«ãªã‚Šã¾ã™ã€‚

## Bellman-Ford Algorithm

ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®èª¬æ˜ã«å…¥ã‚‹å‰ã«ã€å°‘ã—ã‚µã‚¤ã‚¯ãƒ«ã®ã“ã¨ã‚’èª¬æ˜ã—ã¾ã™ã€‚

ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã¯ã‚¦ã‚§ã‚¤ãƒˆãŒæ­£æ•°ã®å ´åˆã«æœ‰åŠ›ã§ã™ãŒã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆãŒå­˜åœ¨ã™ã‚‹ã¨ã€å•é¡Œã¯è¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚

ã‚°ãƒ©ãƒ•ã®ã‚µã‚¤ã‚¯ãƒ«ã«ã¤ã„ã¦ã€**å·¡å›å›³ï¼ˆcyclic graphï¼‰**ã¨**éå·¡å›å›³ï¼ˆacyclic graphï¼‰**ã®ã‚ˆã†ã«æ¦‚å¿µã¨ã—ã¦åŒºåˆ¥ã—ã¦ã„ã¾ã™ã€‚ã‚µã‚¤ã‚¯ãƒ«ã®ãªã„å›³ã«ãŠã„ã¦ã€2ã¤ã®ãƒãƒ¼ãƒ‰ã®é–“ã®çµŒè·¯ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«é™ã‚ŠãŒã‚ã‚Šã¾ã™ãŒã€ã‚µã‚¤ã‚¯ãƒ«ã®ã‚ã‚‹å›³ã«ã¯ã€ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã§å®Ÿéš›ã«çµŒè·¯ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç„¡é™ã«ãªã‚Šã¾ã™ã€‚

æœ€å°ã‚³ã‚¹ãƒˆã®è¨ˆç®—ã«ãŠã„ã¦ã‚‚ã€ã“ã®ã‚µã‚¤ã‚¯ãƒ«ã®æœ‰ç„¡ã¨ã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®æœ‰ç„¡ã«å¤§ããå½±éŸ¿ã•ã‚Œã¾ã™ï¼ˆãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ãŒä½¿ãˆãªã„ï¼‰ã€‚ã•ã‚‰ã«ã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®å­˜åœ¨ã«ã‚ˆã‚Šã€åˆè¨ˆã‚³ã‚¹ãƒˆãŒãƒã‚¤ãƒŠã‚¹ã¨ãªã‚‹ã‚µã‚¤ã‚¯ãƒ«ã‚’ç”Ÿã¿å‡ºã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¸‹è¨˜ã®å·¡å›å›³ã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚

![](https://storage.googleapis.com/zenn-user-upload/6735474bffa4-20230506.png)

ã“ã“ã§ä»®ã«ãƒãƒ¼ãƒ‰Aã‹ã‚‰ãƒãƒ¼ãƒ‰Bã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã®çµŒè·¯ã‚’æ¢ã™ã“ã¨ã¨ã—ã¾ã™ã€‚B->Aã®ã‚¦ã‚§ã‚¤ãƒˆãŒ-4ã¨ãªã‚‹ã®ã§ã€ç†è«–çš„ã«ã‚µã‚¤ã‚¯ãƒ«ã«è¾¿ã‚Œã°ã€A->C->B->A->C->B->...ã®ã‚ˆã†ã«æœ€å°ã‚³ã‚¹ãƒˆãŒç„¡é™ã«å°ã•ããªã£ã¦ã„ãã¾ã™ã€‚ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã‚‹ã¨ã€æœ€å°ã‚³ã‚¹ãƒˆã®çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ãŒï¼ˆå­˜åœ¨ã—ãªã„ãŸã‚ï¼‰ã€ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã¯ã€ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### DPã¨ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•

ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã®ã¨ã“ã‚ã§å°‘ã—è§¦ã‚Œã¾ã—ãŸãŒã€ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã¯DPã‚’é‹ç”¨ã—ã¦ã„ã¾ã™ã€‚DPã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ã„ãˆã°ã€å¤§ããªå•é¡Œã‚’å°ã•ãåˆ†è§£ã—ã€åˆ†è§£ã•ã‚ŒãŸå•é¡Œã®è§£ã‚’çµ„ã¿åˆã‚ã›ã¦æœ€é©è§£ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã§ã™ã€‚ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã‚’ä¸€è¨€ã§è¨€ãˆã°ã€**å§‹ç‚¹ã‹ã‚‰å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã¾ã§ã®åˆè¨ˆæœ€å°ã‚³ã‚¹ãƒˆã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã€ã‚¨ãƒƒã‚¸æ•°ã‚’0ã‹ã‚‰n-1ã¾ã§å¢—ã‚„ã—ã€å„ã‚¨ãƒƒã‚¸æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãŠã‘ã‚‹ã‚³ã‚¹ãƒˆã‚’æ¯”è¼ƒã—ã¦æœ€å°ã‚³ã‚¹ãƒˆã‚’æ›´æ–°ã—ã¦ã„ãï¼ˆaka. edge relaxationï¼‰**ã“ã¨ã§ã™ã€‚ã‚¨ãƒƒã‚¸æ•°ã®å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ä½¿ã‚ã‚Œã‚‹ã‚³ã‚¹ãƒˆã¨ã„ã†ã®ã¯DPã‹ã‚‰ã¿ã¦å•é¡Œã‚’åˆ†è§£ã—ã¦ã„ã‚‹éƒ¨åˆ†ã«å½“ãŸã‚Šã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/18e5d6217361-20230506.gif)
å‡ºå…¸ï¼šhttps://commons.wikimedia.org/wiki/File:Bellman%E2%80%93Ford_algorithm_example.gif

ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ã®ã‚±ãƒ¼ã‚¹ã¯ã•ã¦ãŠãã€ä»Šã¯ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã‚µã‚¤ã‚¯ãƒ«ãŒå­˜åœ¨ã—ãªã„ã‚°ãƒ©ãƒ•ã‚’æƒ³å®šã—ã¦ã‚¹ãƒ†ãƒƒãƒ—ã‚’èª¬æ˜ã—ã¾ã™ã€‚
- å§‹ç‚¹ã‹ã‚‰ã™ã¹ã¦ã®é ‚ç‚¹ã«å¯¾ã—ã¦ã€æœ€çŸ­çµŒè·¯ã®ã‚³ã‚¹ãƒˆã‚’ã€å§‹ç‚¹ã«å¯¾ã—ã¦ã¯0ã€ãã‚Œä»¥å¤–ã®é ‚ç‚¹ã«å¯¾ã—ã¦ã¯`+infinity`ã¨ã—ã¦åˆæœŸåŒ–ã—ã¾ã™
- ã‚°ãƒ©ãƒ•ã®é ‚ç‚¹æ•°-1å›ã¾ã§ã€ã‚°ãƒ©ãƒ•å†…ã®ã™ã¹ã¦ã®ã‚¨ãƒƒã‚¸ã«å¯¾ã—ã¦ä»¥ä¸‹ã®æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ï¼š
  - å„ã‚¨ãƒƒã‚¸`(u, v)`ã«å¯¾ã—ã¦ã€é ‚ç‚¹uã‹ã‚‰vã¸ã®æœ€å°ã‚³ã‚¹ãƒˆã‚’æ›´æ–°ã—ã¾ã™ã€‚
  - ã¤ã¾ã‚Šã€`dist[v] > dist[u] + weight(u, v)` ã§ã‚ã‚Œã°ã€`dist[v] = dist[u] + weight(u, v)` ã¨æ›´æ–°ã€‚

è¨€è‘‰ã ã‘ã§ã¯ç†è§£ã—ã«ãã„ã®ã§ã€å®Ÿéš›ã®ä¾‹ã‚’è¦‹ãŸæ–¹ãŒè‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ä¸‹è¨˜ã®ã‚°ãƒ©ãƒ•ã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚

![](https://storage.googleapis.com/zenn-user-upload/fe459399f934-20230506.png)

ã“ã®ã‚°ãƒ©ãƒ•ã«å¯¾ã—ã¦ã€å§‹ç‚¹ã‚’ãƒãƒ¼ãƒ‰Aã ã¨ä»®å®šã—ã€Aã‹ã‚‰å„ãƒãƒ¼ãƒ‰ã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚ã‚µã‚¤ã‚¯ãƒ«ã¯ã‚ã‚Šã¾ã™ãŒã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚

ã¾ãšã¯DPãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ¬¡ã®ã‚ˆã†ã«åˆæœŸåŒ–ã—ã¾ã™ã€‚

| edge count | A   | B    | C    | D    |
| ---------- | --- | ---- | ---- | ---- |
| 0          | 0   | +inf | +inf | +inf |
| 1          | 0   | +inf | +inf | +inf |
| 2          | 0   | +inf | +inf | +inf |
| 3          | 0   | +inf | +inf | +inf |

ã“ã“ã§ã€`dp[0]["A"]`ã§å–å¾—ã—ãŸå€¤ã¨ã„ã†ã®ã¯ã€å§‹ç‚¹ã‹ã‚‰0æœ¬ã®ã‚¨ãƒƒã‚¸ã‚’ä½¿ã£ã¦ã€ãƒãƒ¼ãƒ‰Aã¾ã§ã®åˆè¨ˆæœ€å°ã‚³ã‚¹ãƒˆã‚’æ„å‘³ã—ã¾ã™ã€‚åŒæ§˜ã«ã€`dp[2]["C"]`ã¨ã„ã†ã®ã¯ã€å§‹ç‚¹ã‹ã‚‰0-2æœ¬ã®ã‚¨ãƒƒã‚¸ã‚’ä½¿ã£ã¦ã€ãƒãƒ¼ãƒ‰Cã¾ã§ã®åˆè¨ˆæœ€å°ã‚³ã‚¹ãƒˆã¨ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã§ãƒ«ãƒ¼ãƒ—ã‚’å§‹ã‚ã‚‹ã¨ã€ã¾ãšã‚¨ãƒƒã‚¸æ•°ãŒ0ã®å ´åˆã¯ã©ã†ãªã‚‹ã‹ã¨ã„ã†ã¨ã€0æœ¬ã‚’ä½¿ã†ã®ã§ã€è‡ªåˆ†è‡ªèº«ä»¥å¤–ã«åˆ°é”ã™ã‚‹ã“ã¨ãŒä¸å¯èƒ½ã§ã€çµå±€`dp[0]["A"]`ä»¥å¤–ã¯å…¨éƒ¨`+inf`ã¨ãªã‚Šã¾ã™ã€‚

ã‚¨ãƒƒã‚¸æ•°ãŒ1ã®å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ã€‚ä½¿ãˆã‚‹ã‚¨ãƒƒã‚¸ã¯0-1æœ¬ã¨ãªã‚Šã¾ã™ãŒã€1æœ¬ã‚’ä½¿ã†å ´åˆã€
- å§‹ç‚¹Aã‹ã‚‰Aã¾ã§ã¯ã‚³ã‚¹ãƒˆ0ã®ã¾ã¾
- å§‹ç‚¹Aã‹ã‚‰Bã¾ã§ã¯ã‚¦ã‚§ã‚¤ãƒˆ10ã®ã‚¨ãƒƒã‚¸ãŒå­˜åœ¨â†’0æœ¬ã®å ´åˆã®`+inf`ã‚ˆã‚Šå°ã•ã„ã®ã§ã€æœ€å°ã‚³ã‚¹ãƒˆã‚’10ã¨ã—ã¦æ›´æ–°
- å§‹ç‚¹Aã‹ã‚‰Cã¾ã§ã¯ã‚¦ã‚§ã‚¤ãƒˆ50ã®ã‚¨ãƒƒã‚¸ãŒå­˜åœ¨â†’Bã¨åŒæ§˜ã«æœ€å°ã‚³ã‚¹ãƒˆã‚’50ã¨ã—ã¦æ›´æ–°
- å§‹ç‚¹Aã‹ã‚‰Dã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã¯ä¸Šè¨˜ã¨åŒæ§˜20ã¨ã—ã¦æ›´æ–°

ã“ã‚Œã§ä¸€å‘¨ãŒçµ‚ã‚ã‚‹ã¨ã€DPãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä»¥ä¸‹ã¨æ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚

| edge count | A   | B    | C    | D    |
| ---------- | --- | ---- | ---- | ---- |
| 0          | 0   | +inf | +inf | +inf |
| 1          | 0   | 10   | 50   | 20   |
| 2          | 0   | +inf | +inf | +inf |
| 3          | 0   | +inf | +inf | +inf |

æ¬¡ã«ã‚¨ãƒƒã‚¸æ•°ãŒ2ã®å ´åˆã‚’è¦‹ã¾ã™ã€‚ä½¿ãˆã‚‹ã‚¨ãƒƒã‚¸ã¯0-2æœ¬ã¨ãªã‚Šã¾ã™ãŒã€ã™ã§ã«0ã¨1æœ¬ã‚’ä½¿ã†å ´åˆã®æœ€å°ã‚³ã‚¹ãƒˆãŒå¾—ã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€ã“ã“ã¯2æœ¬ã‚’ä½¿ã†å ´åˆã‚’è€ƒãˆã‚‹ã ã‘ã§è‰¯ã„ã®ã§ã™ã€‚
- å§‹ç‚¹Aã‹ã‚‰Aã¾ã§ã®ã‚³ã‚¹ãƒˆã¯0ã®ã¾ã¾
- å§‹ç‚¹Aã‹ã‚‰Bã¾ã§ã¯ã€ä»®ã«ã‚¨ãƒƒã‚¸2æœ¬ã‚’ä½¿ã†ã¨A->D->Bã®é †ã§è¡Œã‘ã‚‹â†’Aã‹ã‚‰Dã¾ã§1æœ¬ã‚’ä½¿ã†ã¨20ãªã®ã§ã€Dã‹ã‚‰Bã¾ã§ã®-15ã¨åŠ ç®—ã—ã¦5ã¨ãªã‚‹â†’ç¾åœ¨æœ€å°ã‚³ã‚¹ãƒˆã¯10ãªã®ã§ã€5ã¨ã—ã¦æ›´æ–°
- å§‹ç‚¹Aã‹ã‚‰Cã¾ã§ã¯ã€ä»®ã«ã‚¨ãƒƒã‚¸2æœ¬ã‚’ä½¿ã†ã¨A->B->Cã®é †ã§è¡Œã‘ã‚‹â†’Aã‹ã‚‰Bã¾ã§1æœ¬ã‚’ä½¿ã†ã¨10ãªã®ã§ã€Bã‹ã‚‰Cã¾ã§ã®10ã¨åŠ ç®—ã—ã¦20ã¨ãªã‚‹â†’ç¾åœ¨æœ€å°ã‚³ã‚¹ãƒˆã¯50ãªã®ã§ã€20ã¨ã—ã¦æ›´æ–°
- å§‹ç‚¹Aã‹ã‚‰Dã¾ã§ã¯ã€ä»®ã«ã‚¨ãƒƒã‚¸2æœ¬ã‚’ä½¿ã†ã¨A->C->Dã®é †ã§è¡Œã‘ã‚‹â†’Aã‹ã‚‰Cã¾ã§1æœ¬ã‚’ä½¿ã†ã¨50ãªã®ã§ã€Cã‹ã‚‰Dã¾ã§ã®10ã¨åŠ ç®—ã—ã¦60ã¨ãªã‚‹â†’ç¾åœ¨æœ€å°ã‚³ã‚¹ãƒˆã¯20ãªã®ã§ã€æ›´æ–°ã¯ä¸è¦

ã“ã‚Œã§äºŒé€±ç›®ãŒçµ‚ã‚ã‚‹ã¨ã€DPãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä»¥ä¸‹ã¨æ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚

| edge count | A   | B    | C    | D    |
| ---------- | --- | ---- | ---- | ---- |
| 0          | 0   | +inf | +inf | +inf |
| 1          | 0   | 10   | 50   | 20   |
| 2          | 0   | 5    | 20   | 20   |
| 3          | 0   | +inf | +inf | +inf |

æœ€å¾Œã¯ã‚¨ãƒƒã‚¸æ•°ãŒ3ã®å ´åˆã‚’è¦‹ã¾ã™ã€‚ä¸Šè¨˜ã¨åŒæ§˜ã«ã€ã‚¨ãƒƒã‚¸2æœ¬ã®æœ€å°å€¤ã¯ã™ã§ã«å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¨ˆç®—æ¸ˆã¿ãªã®ã§ã€ã“ã“ã¯3æœ¬ã‚’ä½¿ã†å ´åˆã®ã¿ã‚’è€ƒãˆã¾ã™ã€‚
- å§‹ç‚¹Aã‹ã‚‰Aã¾ã§ã®ã‚³ã‚¹ãƒˆã¯0ã®ã¾ã¾
- å§‹ç‚¹Aã‹ã‚‰Bã¾ã§ã¯ã€ã‚¨ãƒƒã‚¸3æœ¬ã‚’ä½¿ã£ã¦è¡Œã‘ã‚‹ãƒ«ãƒ¼ãƒˆãŒãªã„ã®ã§ã€æ›´æ–°ã¯ä¸è¦
- å§‹ç‚¹Aã‹ã‚‰Cã¾ã§ã¯ã€ä»®ã«ã‚¨ãƒƒã‚¸3æœ¬ã‚’ä½¿ã†ã¨A->D->B->Cã®é †ã§è¡Œã‘ã‚‹â†’Aã‹ã‚‰Bã¾ã§2æœ¬ã‚’ä½¿ã†ã¨5ãªã®ã§ã€Bã‹ã‚‰Cã¾ã§ã®10ã¨åŠ ç®—ã—ã¦15ã¨ãªã‚‹â†’ç¾åœ¨æœ€å°ã‚³ã‚¹ãƒˆã¯25ãªã®ã§ã€15ã¨ã—ã¦æ›´æ–°
- å§‹ç‚¹Aã‹ã‚‰Dã¾ã§ã¯ã€ä»®ã«ã‚¨ãƒƒã‚¸3æœ¬ã‚’ä½¿ã†ã¨A->B->C->Dã®é †ã§è¡Œã‘ã‚‹â†’Aã‹ã‚‰Cã¾ã§2æœ¬ã‚’ä½¿ã†ã¨20ãªã®ã§ã€Cã‹ã‚‰Dã¾ã§ã®10ã¨åŠ ç®—ã—ã¦30ã¨ãªã‚‹â†’ç¾åœ¨æœ€å°ã‚³ã‚¹ãƒˆã¯20ãªã®ã§ã€æ›´æ–°ã¯ä¸è¦

æœ€çµ‚çš„ã«DPãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä»¥ä¸‹ã¨ãªã‚Šã¾ã™ã€‚

| edge count | A   | B    | C    | D    |
| ---------- | --- | ---- | ---- | ---- |
| 0          | 0   | +inf | +inf | +inf |
| 1          | 0   | 10   | 50   | 20   |
| 2          | 0   | 5    | 20   | 20   |
| 3          | 0   | 5    | 15   | 20   |

ã“ã‚Œã§ã€å§‹ç‚¹Aã‹ã‚‰Bã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã¯5ã€Cã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã¯15ã€Dã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã¯20ã¨ã„ã†ãµã†ã«çµè«–ä»˜ã‘ã‚‰ã‚Œã¾ã™ã€‚

### ã‚³ãƒ¼ãƒ‰åŒ–

ä¸Šè¨˜ã®ä¾‹ã‚’ã‚³ãƒ¼ãƒ‰åŒ–ã™ã‚‹ã¨ã©ã†ãªã‚‹ã‹ã€è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼ˆãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ã®æ¤œçŸ¥ã«ã¤ã„ã¦ã¾ãŸå¾Œã®ç¯€ã§ï¼‰ã€‚

```js
function bellmanFord(graph, start) {
  const n = getSizeFromEdges(graph);
  const dp = Array.from({ length: n }, () => Array(n).fill(Infinity));

  // Initialize the DP table
  dp[0][start] = 0;

  // 0ã‹ã‚‰n-1ã¾ã§ãƒ«ãƒ¼ãƒ—ã™ã‚‹
  for (let i = 1; i < n; i++) {
    // ã‚°ãƒ©ãƒ•ã¯ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆã§è¡¨ç¾
    for (const [src, dst, weight] of graph) { 
    // å‰ã®è¡Œã®æœ€å°ã‚³ã‚¹ãƒˆã«ã€ç¾åœ¨ã®ã‚¦ã‚§ã‚¤ãƒˆã‚’åŠ ç®—ã—ã¦åˆ¤æ–­ã™ã‚‹
      const prevMinCost = dp[i - 1][src]
      if (prevMinCost + weight < dp[i][dst]) {
        dp[i][dst] = prevMinCost + weight;
      }
    }
  }

  // TODO: Check for negative weight cycles

  // æœ€å¾Œã®è¡Œã®ãƒ‡ãƒ¼ã‚¿ãŒå§‹ç‚¹ã‹ã‚‰å„ãƒãƒ¼ãƒ‰ã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆ
  return dp[n - 1];
}

// ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆã‹ã‚‰ãƒãƒ¼ãƒ‰ã®æ•°ã‚’è¨ˆç®—ã™ã‚‹
function getSizeFromEdges(edges) {
  // ãƒãƒ¼ãƒ‰ã®å€¤ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ã¨ã®å‰æ
  const nodes = new Set();
  for (const [u, v] of graph) {
    nodes.add(u);
    nodes.add(v);
  }
  return nodes.size;
}
```

æ™‚é–“è¤‡é›‘åº¦ã«ã¤ã„ã¦ã€å…¨ã¦ã®ãƒãƒ¼ãƒ‰ãŒãŠäº’ã„ã«ç¹‹ã„ã§ã„ã‚‹å ´åˆï¼ˆæœ€æ‚ªã®ã‚±ãƒ¼ã‚¹ï¼‰ã€`O(V*E)`ã¨ãªã‚Šã¾ã™ã€‚ç©ºé–“è¤‡é›‘åº¦ã¯ã€DPãƒ†ãƒ¼ãƒ–ãƒ«ã®`O(V*V)`ã¨ãªã‚‹ã®ã§ã™ã€‚

### DPãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æœ€é©åŒ–

ä¸Šè¨˜ã®ä¾‹ã§ã™ã§ã«ã‚ã‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€æ¯å›ã®ãƒ«ãƒ¼ãƒ—ã«ãŠã„ã¦ã€å¿…è¦ã¨ã•ã‚Œã‚‹ã®ã¯å‰å›ã®ãƒ«ãƒ¼ãƒ—ã«ãŠã‘ã‚‹å„æœ€å°ã‚³ã‚¹ãƒˆã ã‘ã¨ãªã£ã¦ã„ã¾ã™ã€‚ä»®ã«ãƒãƒ¼ãƒ‰ã¯100å€‹ã‚ã‚‹ã¨ã™ã‚Œã°ã€ä¸Šè¨˜ã®ã‚„ã‚Šæ–¹ã§ã¯100è¡Œã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€äº‹å®Ÿä¸Šå‰å›åˆ†ã¨ä»Šå›åˆ†ã®2è¡Œã®ã¿ã§è¡Œã‘ã‚‹ã¯ãšã€ã¨ã®ã“ã¨ã§ã™ã€‚ã¤ã¾ã‚Šã€ä¸Šè¨˜ã®ç©ºé–“è¤‡é›‘åº¦ã‚’ã€ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ã®`O(V*V)`ã‹ã‚‰é…åˆ—ã®`O(V)`ã¾ã§æœ€é©åŒ–ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

```js
function bellmanFord(graph, start) {
  const n = getSizeFromEdges(graph);
  const dist = Array(n).fill(Infinity);

  dist[start] = 0;

  for (let i = 1; i < n; i++) {
    const prevDist = [...dist]; // å‰ã®è¡Œã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã‚³ãƒ”ãƒ¼
    for (const [src, dst, weight] of graph) {
      if (prevDist[src] + weight < dist[dst]) {
        dist[dst] = prevDist[src] + weight;
      }
    }
  }

  return dist;
}
```

æ™‚é–“è¤‡é›‘åº¦ã«ã‚‚æœ€é©åŒ–ã™ã‚‹ä½™åœ°ã¯ã‚ã‚Šã¾ã™ã€‚ä»®ã«ã‚¨ãƒƒã‚¸2æœ¬ä»¥é™ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€3æœ¬ã§ã‚‚4æœ¬ã§ã‚‚æ›´æ–°ãŒè¡Œã‚ãªã‹ã£ãŸã‚‰ã€2æœ¬ã®æ™‚ç‚¹ã§ã™ã§ã«æœ€å°ã‚³ã‚¹ãƒˆã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã™ã‚‹ã¨ã€**æ›´æ–°ãŒè¡Œã‚ã‚ŒãŸã‹ã©ã†ã‹ã‚’è¿½è·¡ã™ã‚‹**ã“ã¨ã§ã€ãƒ«ãƒ¼ãƒ—ã‹ã‚‰æ—©æœŸãƒ–ãƒ¬ãƒ¼ã‚¯ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

```js
function bellmanFord(graph, start) {
  const n = getSizeFromEdges(graph);
  const dist = Array(n).fill(Infinity);

  dist[start] = 0;

  for (let i = 1; i < n; i++) {
    let updated = false;
    const prevDist = [...dist]; // å‰ã®è¡Œã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã‚³ãƒ”ãƒ¼

    for (const [src, dst, weight] of graph) {
      if (prevDist[src] + weight < dist[dst]) {
        dist[dst] = prevDist[src] + weight;
        updated = true;
      }
    }

    if (!updated) break; // æ›´æ–°ãŒãªã‘ã‚Œã°ã™ã§ã«æœ€å°ã‚³ã‚¹ãƒˆã«é”ã—ã¦ã„ã‚‹
  }

  return dist;
}
```

ã“ã‚Œã§æ™‚é–“è¤‡é›‘åº¦ã¯ã€`<=O(V*E)`ã¨ãªã‚Šã¾ã—ãŸã€‚

### ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã‚µã‚¤ã‚¯ãƒ«ï¼ˆè² ã®é‡ã¿é–‰è·¯ï¼‰ã®æ¤œçŸ¥

ã§ã¯ã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ã®å­˜åœ¨ã¯ã©ã®ã‚ˆã†ã«æ¤œçŸ¥ã§ãã‚‹ã®ã§ã—ã‚‡ã†ã‹ã€‚

ä¸Šè¨˜ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒçµ‚ã‚ã‚‹ã¨ã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ãŒå­˜åœ¨ã—ãªã‘ã‚Œã°ã€æœ€å¾Œã®è¡Œã®ãƒ‡ãƒ¼ã‚¿ã¯æœ€å°ã‚³ã‚¹ãƒˆã«ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚é€†ã«è¨€ãˆã°ã€ãƒ«ãƒ¼ãƒ—çµ‚äº†å¾Œã«ã„ãšã‚Œã‹ã®ãƒãƒ¼ãƒ‰srcã‹ã‚‰ã„ãšã‚Œã‹ã®ãƒãƒ¼ãƒ‰dstã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆ`prev[src]`ã«ã€ã‚¨ãƒƒã‚¸ã§å®šç¾©ã•ã‚ŒãŸã‚¦ã‚§ã‚¤ãƒˆã‚’ä¹—ã›ã¦ã€è©²å½“ãƒãƒ¼ãƒ‰ã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆ`prev[dst]`ã‚ˆã‚Šã‚‚å°ã•ããªã‚Œã°ã€ç„¡é™ã«å°ã•ããªã‚‹ã“ã¨ãŒã§ãã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã‚µã‚¤ã‚¯ãƒ«ã®å­˜åœ¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```js
function bellmanFord(graph, start) {
  const n = getSizeFromEdges(graph);
  const dist = Array(n).fill(Infinity);

  dist[start] = 0;

  while (true) {
    let updated = false;
    const prevDist = [...dist]; // å‰ã®è¡Œã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã‚³ãƒ”ãƒ¼

    for (const [src, dst, weight] of graph) {
      if (prevDist[src] + weight < dist[dst]) {
        dist[dst] = prevDist[src] + weight;
        updated = true;
      }
    }

    if (!updated) break; // æ›´æ–°ãŒãªã‘ã‚Œã°ã™ã§ã«æœ€å°ã‚³ã‚¹ãƒˆã«é”ã—ã¦ã„ã‚‹
  }

  // çµ‚äº†å¾Œã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
  for (const [src, dst, weight] of graph) {
    // ã™ã§ã«æœ€å°ã§ã‚ã‚Œã°ã“ã“ã¯ã‚ã‚Šå¾—ãªã„ã¯ãš
    if (prev[src] + weight < prev[dst]) {
      throw new Error("Graph contains a negative-weight cycle");
    }
  }

  return prev;
}
```

## SPFA Algorithm

ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã«å¯¾ã—ã¦ã€ã•ã‚‰ã«æœ€é©åŒ–ã—ãŸSPFA(Shortest Path Faster Algorithm)ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã‚ã‚Šã¾ã™ã€‚ä¸€è¨€ã§è¨€ãˆã°ã€DPãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»é…åˆ—ã®ä»£ã‚ã‚Šã«ã€**ã‚­ãƒ¥ãƒ¼ã‚’åˆ©ç”¨ã—ã¦å„ãƒãƒ¼ãƒ‰ã¾ã§ã®æœ€å°ã‚³ã‚¹ãƒˆã‚’æ›´æ–°ã™ã‚‹ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã®æ”¹å–„ç‰ˆ**ã§ã™ã€‚

ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»¥ä¸‹ã¨ãªã‚Šã¾ã™ã€‚
- å§‹ç‚¹ã‹ã‚‰ã™ã¹ã¦ã®é ‚ç‚¹ã«å¯¾ã—ã¦ã€æœ€çŸ­çµŒè·¯ã®ã‚³ã‚¹ãƒˆã‚’ã€å§‹ç‚¹ã«å¯¾ã—ã¦ã¯0ã€ãã‚Œä»¥å¤–ã®é ‚ç‚¹ã«å¯¾ã—ã¦ã¯`+infinity`ã¨ã—ã¦åˆæœŸåŒ–ã—ã¾ã™
- å§‹ç‚¹ãƒãƒ¼ãƒ‰ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã—ã¾ã™
- ã‚­ãƒ¥ãƒ¼ãŒã‹ã‚‰ã«ãªã‚‹ã¾ã§ã€ä»¥ä¸‹ã®æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ï¼š
  - ã‚­ãƒ¥ãƒ¼ã‹ã‚‰ãƒãƒ¼ãƒ‰`u`ã‚’å–å¾—ã—ã¾ã™
  - ãƒãƒ¼ãƒ‰`u`ã«éš£æ¥ã™ã‚‹å…¨ã¦ã®é ‚ç‚¹ã‚’ãƒ«ãƒ¼ãƒ—
    - `u`ã‹ã‚‰éš£æ¥ã®`v`ã¾ã§ã®ã‚¦ã‚§ã‚¤ãƒˆã‚’`dist[u]`ã¸åŠ ç®—ã—ã€ç¾åœ¨ã®`dist[v]`ã¨æ¯”è¼ƒã—ã¾ã™
    - `dist[v] > dist[u] + weight(u, v)` ã§ã‚ã‚Œã°ã€`dist[v] = dist[u] + weight(u, v)` ã¨æ›´æ–°ã€‚
    - åŒæ™‚ã«æ›´æ–°ã•ã‚ŒãŸãƒãƒ¼ãƒ‰`v`ã‚’ã‚­ãƒ¥ãƒ¼ã«ãƒ—ãƒƒã‚·ãƒ¥

```js
function spfa(graph, start) {
  const n = getSizeFromEdges(graph);

  const dist = new Array(n).fill(Infinity);
  dist[start] = 0;

  // å¿…è¦ãªãƒãƒ¼ãƒ‰ã®ã¿ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã™ã‚‹
  const queue = [start];

  while (queue.length > 0) {
    const u = queue.shift();

    for (const [src, dst, weight] of graph) {
      if (src === u) {
        const v = dst;

        if (dist[u] + weight < dist[v]) {
          dist[v] = dist[u] + weight;
          // æ›´æ–°ãŒè¡Œã‚ã‚ŒãŸãƒãƒ¼ãƒ‰ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 
          queue.push(v);
        }
      }
    }
  }

  // ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ãƒã‚§ãƒƒã‚¯...

  return dist;
}
```

ã‚‚ã¡ã‚ã‚“ã€ã‚°ãƒ©ãƒ•ã‚’ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆã§ã¯ãªãã€éš£æ¥ãƒªã‚¹ãƒˆã®å½¢ã§è¡¨ç¾ã™ã‚‹ã¨ã€ã‚ˆã‚Šã™ã£ãã‚Šã«è¦‹ãˆã¾ã™ã—ã€éš£æ¥ã™ã‚‹ãƒãƒ¼ãƒ‰ã ã‘ãƒ«ãƒ¼ãƒ—ã™ã‚‹ã®ã§ã€ã‚¹ãƒ‘ãƒ¼ã‚¹ã‚°ãƒ©ãƒ•ã®å ´åˆåŠ¹ç‡ã¯è‰¯ããªã‚Šã¾ã™ã€‚

```js
function spfa(graph, source) {
  const n = graph.length;
  const dist = Array(n).fill(Infinity);
  // ã™ã§ã«ã‚­ãƒ¥ãƒ¼ã«å­˜åœ¨ã™ã‚‹ãƒãƒ¼ãƒ‰ã®é‡è¤‡ãƒ—ãƒƒã‚·ãƒ¥ã‚’é¿ã‘ã‚‹ãŸã‚ã«
  const inQueue = Array(n).fill(false);
  const queue = [];

  dist[source] = 0;
  queue.push(source);
  inQueue[source] = true;

  while (queue.length > 0) {
    const u = queue.shift();
    inQueue[u] = false;

    for (const [v, weight] of graph[u]) {
      const newDist = dist[u] + weight;
      if (newDist < dist[v]) {
        dist[v] = newDist;
        if (!inQueue[v]) {
          queue.push(v);
          inQueue[v] = true;
        }
      }
    }
  }

  return dist;
}
```

æ™‚é–“è¤‡é›‘åº¦ã«ã¤ã„ã¦ã€æœ€æ‚ªã®ã‚±ãƒ¼ã‚¹ã¯ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã¨åŒã˜ã`O(V*E)`ã¨ãªã‚Šã¾ã™ãŒã€ã‚­ãƒ¥ãƒ¼ã«å…¥ã£ã¦ã„ã‚‹ãƒãƒ¼ãƒ‰ã®ã¿ã«å¯¾ã—ã¦ãƒ«ãƒ¼ãƒ—ã™ã‚‹ã®ã§ã€é€šå¸¸ã¯`O(E)`ã«è¿‘ã„åŠ¹ç‡ã«ãªã‚‹ã‚‰ã—ã„ã§ã™ï¼ˆãŒã€ç›´æ¥ãªè¨¼æ˜ã¨å‡ºå…¸ãŒè¦‹ã¤ã‹ã£ã¦ã„ã¾ã›ã‚“ï¼‰ã€‚ç©ºé–“ã«ã¤ã„ã¦åŒã˜ã`O(V)`ã¨ãªã‚Šã¾ã™ã€‚

## å®Ÿè·µå•é¡Œ

ã¾ãšã¯[743. Network Delay Time](https://leetcode.com/problems/network-delay-time/description/)ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

![](https://storage.googleapis.com/zenn-user-upload/40ca98244edf-20230506.png)

åŸºæœ¬ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆãŒãªã‘ã‚Œã°Dijkstraæ³•ã‹Bellman-Fordæ³•ã®ã„ãšã‚Œã‹è§£æ±ºã§ãã¾ã™ãŒã€ã¾ãšã¯Dijkstraã‚’ã¿ã¦ã¿ã€‚éš£æ¥ãƒªã‚¹ãƒˆã®æ–¹ã§ã‚„ã‚Šã‚„ã™ã„ã®ã§ã¾ãšã¯`times`ã‹ã‚‰ä½œæˆã—ãŸæ–¹ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚

```python
import heapq

def networkDelayTime(times, n, k):
    # ã‚°ãƒ©ãƒ•ã‚’è¡¨ã™éš£æ¥ãƒªã‚¹ãƒˆã‚’ä½œæˆ
    graph = {}
    for u, v, w in times:
        if u not in graph:
            graph[u] = [j
        graph[u].append((v, w))

    pq = [(0, k)]  # heapã§ã®ä¿å­˜å½¢å¼ã¯[cost, node]
    # æœ€çŸ­ãƒ‘ã‚¹ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ã‚³ã‚¹ãƒˆé…åˆ—ã‚’infinityã¨ã—ã¦åˆæœŸåŒ–
    dist = [float('inf')] * (n + 1)
    dist[k] = 0

    # ãƒ’ãƒ¼ãƒ—ã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹é™ã‚Šç¶šã‘ã‚‹
    while pq:
        dist, node = heapq.heappop(pq)
        # æ—¢å­˜ã®æœ€å°ã‚³ã‚¹ãƒˆã‚ˆã‚Šã‚‚å¤§ãã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
        if dist > dist[node]:
            continue
        # ç¾åœ¨ã®ãƒãƒ¼ãƒ‰ã«éš£æ¥ã™ã‚‹ãƒãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã¯ãã‚Œã‚‰ã‚’æ¢ç´¢
        if node in graph:
            for neighbor, weight in graph[node]:
                newDist = dist + weight
                # ç¾å­˜ã®æœ€å°ã‚³ã‚¹ãƒˆã‚ˆã‚Šå°ã•ã„å ´åˆã¯å€¤ã‚’æ›´æ–°
                if newDist < dist[neighbor]:
                    dist[neighbor] = newDist
                    heapq.heappush(pq, (newDist, neighbor))

    # ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã‹ã‚‰ã®æœ€å¤§è·é›¢ã‚’å–å¾—ã€0ç•ªã¯ã„ã‚‰ãªã„ã®ã§æ³¨æ„
    maxDist = max(dist[1:])

    # ã™ã¹ã¦ã®ãƒãƒ¼ãƒ‰ãŒåˆ°é”å¯èƒ½ï¼infinityãŒãªã„çŠ¶æ…‹ã§ã‚ã‚Œã°æœ€å¤§ã‚³ã‚¹ãƒˆã‚’ãƒªã‚¿ãƒ¼ãƒ³
    return -1 if maxDist == float('inf') else maxDist
```

æ¬¡ã«[787. Cheapest Flights Within K Stops](https://leetcode.com/problems/cheapest-flights-within-k-stops/description/)ã‚’ã¿ã¦ã¿ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/64b76eaa88d3-20230506.png)

ã“ã®å•é¡Œã¯Dijkstraæ³•ã¨Bellman-Fordæ³•ã®ã„ãšã‚Œã‹ã§è§£æ±ºã§ãã¾ã™ãŒã€ã“ã“ã¯Bellman-Fordæ³•ã§ã€‚

```js
function findCheapestPrice(n, flights, src, dst, k) {
  // åˆæœŸåŒ–
  // æœ€çŸ­è·é›¢ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®é…åˆ— (1æ¬¡å…ƒ)
  const dist = Array(n).fill(Infinity);
  dist[src] = 0; // ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã®è·é›¢ã¯0

  // Kå›ã®ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦æ¢ç´¢
  for (let i = 0; i < k + 1; i++) {
    // 1ã¤å‰ã®è·é›¢ã‚’ä¿å­˜ã™ã‚‹é…åˆ—ã‚’ä½œæˆ
    const prevDist = [...dist];

    // å…¨ã¦ã®ãƒ•ãƒ©ã‚¤ãƒˆã«å¯¾ã—ã¦ã€æ›´æ–°å¯èƒ½ãªè·é›¢ã‚’ç¢ºèª
    for (const [u, v, w] of flights) {
      // ç¾åœ¨ã®è·é›¢ã‚ˆã‚Šã‚‚ã€æ–°ã—ã„çµŒè·¯ã‚’ä½¿ã£ãŸè·é›¢ãŒçŸ­ã„å ´åˆã€è·é›¢ã‚’æ›´æ–°
      if (prevDist[u] + w < dist[v]) {
        dist[v] = prevDist[u] + w;
      }
    }
  }

  // ã‚‚ã—ç›®çš„åœ°ã¸ã®è·é›¢ãŒç„¡é™å¤§ã§ãªã‘ã‚Œã°ã€ãã®è·é›¢ã‚’è¿”ã™
  // ãã†ã§ãªã‘ã‚Œã°ã€-1ã‚’è¿”ã™
  return dist[dst] !== Infinity ? dist[dst] : -1;
}
```


## ã¾ã¨ã‚

ã“ã‚Œã§å˜ä¸€å§‹ç‚¹æœ€çŸ­çµŒè·¯å•é¡Œã«ã¤ã„ã¦ã‚ˆãè¦‹ã‚‰ã‚Œã‚‹3ã¤ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ãã¾ã—ãŸã€‚ãã‚Œãã‚Œã®æ™‚é–“è¤‡é›‘åº¦ã¨ç©ºé–“è¤‡é›‘åº¦ã€ãŠã‚ˆã³ã‚°ãƒ©ãƒ•ã®ç‰¹æ€§ï¼ˆæœ‰å‘/ç„¡å‘ã€é‡ã¿ä»˜ã/éé‡ã¿ä»˜ãã€è² ã®é‡ã¿ã®æœ‰ç„¡ã€è² ã®é‡ã¿ã®ã‚µã‚¤ã‚¯ãƒ«ã®æœ‰ç„¡ï¼‰ã«åŸºã¥ã„ã¦é©ç”¨å¯èƒ½ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

| ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ          | æ™‚é–“è¤‡é›‘åº¦                | ç©ºé–“è¤‡é›‘åº¦ | æœ‰å‘ | ç„¡å‘ | é‡ã¿ä»˜ã | éé‡ã¿ä»˜ã | è² ã®é‡ã¿ | è² ã®é‡ã¿ã®ã‚µã‚¤ã‚¯ãƒ« |
| -------------------- | ------------------------- | ---------- | ---- | ---- | -------- | ---------- | -------- | ------------------ |
| ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•       | `O(V^2)` or `O(E+V*logV)` | `O(V)`     | â—¯    | â—¯    | â—¯        | â—¯          | Ã—        | Ã—                  |
| ãƒ™ãƒ«ãƒãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒ‰æ³• | `O(V*E)`                  | `O(V)`     | â—¯    | â—¯    | â—¯        | â—¯          | â—¯        | â–³*                 |
| SPFA                 | `O(E)`~`O(VE)`            | `O(V)`     | â—¯    | â—¯    | â—¯        | â—¯          | â—¯        | â–³*                 |

*ãƒ™ãƒ«ãƒãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ãŠã‚ˆã³SPFAã¯ã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ã‚’æ¤œå‡ºã§ãã¾ã™ãŒã€ãƒã‚¤ãƒŠã‚¹ã‚¦ã‚§ã‚¤ãƒˆã®ã‚µã‚¤ã‚¯ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€æœ€çŸ­çµŒè·¯ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€çµæœã¯æ±‚ã‚ã‚‰ã‚Œã¾ã›ã‚“ã€‚

ã“ã®è¾ºã‚Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã€ãƒ’ãƒ¼ãƒ—ã‚„DPã®å‰çŸ¥è­˜ãŒå¿…è¦ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€æ¯”è¼ƒçš„ã«é›£ã—ã„æ–¹ã‹ãªã¨æ€ã„ã¾ã™ã€‚è‡ªåˆ†ã‚‚ç†è§£ã™ã‚‹ãŸã‚ã«çµæ§‹è‹¦åŠ´ã—ã¾ã—ãŸãŒã€ã‚ã‹ã£ãŸå¾Œã®æ°—æŒã¡ã¯é¬±æ†¤ã‚’æ‰•ã£ãŸã‚ˆã†ãªæ¸…ã€…ã—ã•ã«ãªã£ã¦ã„ã¦ã€ä¾¡å€¤ã¯ã‚ã‚‹ã¨æ€ã„ã¾ã—ãŸï¼ˆç¬‘ï¼‰ã€‚

æ¬¡å›ã¯æœ€çµ‚å›ã®å…¨ç‚¹å¯¾æœ€çŸ­çµŒè·¯å•é¡Œã«ã¤ã„ã¦æ›¸ã„ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã§ã¯ã§ã¯ã€‚
